name: Sync SFX from Google Drive

on:
  workflow_dispatch:
    inputs:
      drive_url:
        description: 'Your Google Drive Folder URL (ржпрзЗржЦрж╛ржирзЗ ржЖржкржирж┐ рж░рж┐ржирзЗржо ржХрж░рзЗ ржлрж╛ржЗрж▓ рж╕рзЗржн ржХрж░рзЗржЫрзЗржи)'
        required: true
        type: string

jobs:
  sync_sfx:
    runs-on: ubuntu-latest
    permissions:
      contents: write  # рж░рж┐ржкрзЛржЬрж┐ржЯрж░рж┐рждрзЗ ржбрж┐рж▓рж┐ржЯ ржПржмржВ ржирждрзБржи ржлрж╛ржЗрж▓ ржкрзБрж╢ ржХрж░рж╛рж░ ржкрж╛рж░ржорж┐рж╢ржи

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'

      - name: Install gdown (Drive Downloader)
        run: pip install gdown

      - name: Delete Old SFX Files
        run: |
          echo "Deleting old sound effects..."
          # ржлрзЛрж▓рзНржбрж╛рж░ ржерж╛ржХрж▓рзЗ ржнрзЗрждрж░рзЗрж░ рж╕ржм ржлрж╛ржЗрж▓ ржорзБржЫрзЗ ржлрзЗрж▓ржмрзЗ, ржирж╛ ржерж╛ржХрж▓рзЗ ржлрзЛрж▓рзНржбрж╛рж░ржЯрж┐ рждрзИрж░рж┐ ржХрж░ржмрзЗ
          rm -rf assets/soundEffects/*
          mkdir -p assets/soundEffects
          echo "тЬЕ Old files deleted successfully."

      - name: Download New SFX Files
        run: |
          echo "Downloading new files from Google Drive..."
          # gdown ржжрж┐рзЯрзЗ ржлрзЛрж▓рзНржбрж╛рж░ ржбрж╛ржЙржирж▓рзЛржб ржХрж░рж╛
          gdown "${{ inputs.drive_url }}" -O assets/soundEffects --folder --remaining-ok

      - name: Verify Downloads
        run: |
          echo "ЁЯУВ Downloaded files:"
          ls -R assets/soundEffects

      - name: Commit and Push Changes
        run: |
          git config --global user.name "github-actions[bot]"
          git config --global user.email "github-actions[bot]@users.noreply.github.com"
          
          # ржбрж┐рж▓рж┐ржЯ рж╣ржУрзЯрж╛ ржПржмржВ ржирждрзБржи ржпрзЛржЧ рж╣ржУрзЯрж╛ рж╕ржм ржлрж╛ржЗрж▓ ржЯрзНрж░рзНржпрж╛ржХрж┐ржВрзЯрзЗ ржЖржирж╛
          git add assets/soundEffects/
          
          # ржпржжрж┐ ржХрзЛржирзЛ ржкрж░рж┐ржмрж░рзНрждржи ржерж╛ржХрзЗ рждржмрзЗржЗ ржкрзБрж╢ ржХрж░ржмрзЗ
          if git diff --staged --quiet; then
            echo "No changes found. Everything is up to date."
          else
            git commit -m "ЁЯФД Synced fresh sound effects from Google Drive"
            git push
            echo "тЬЕ Successfully synced to GitHub!"
          fi
